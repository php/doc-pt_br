 <appendix id="debugger">
  <title>O debugador do PHP</title>

  <sect1 id="debugger-using">
   <title>Usando o Debugador</title>

   <para>
    O debugger do PHP é util para procurar "bugs" simples.
    O debugador trabalha conectando numa porta <acronym>TCP</acronym> para cada seção PHP aberta. Todas as mensagens de erro serão enviadas a esta conecção TCP.
    Esta informação tem intenção de "debugar" o servidor de dentro de um sistema
    <acronym>IDE</acronym> ou editor de arquivos programável (como o Emacs).
   </para>
   <para>
    Como levantar o debugger:
    <orderedlist>
     <listitem>
      <simpara> 
       Configure  uma porta TCP para ele no <link
       linkend="configuration.file">arquivo de configuração</link> (<link
       linkend="ini.debugger.port">debugger.port</link>) e habilite ele 
       (<link linkend="ini.debugger.enabled">debugger.enabled</link>).
      </simpara>
     </listitem>
     <listitem>
      <simpara> 
       Configure um "ouvidor" TCP naquela porta em algum programa (por exemplo
       <command>socket -l -s 1400</command> no UNIX).
      </simpara>
     </listitem>
     <listitem>
      <simpara> 
       Em seu código execute "debugger_on(<replaceable>máquina</replaceable>)", onde <replaceable>máquina</replaceable> é o número IP ou nome do computador executando o "ouvidor" <acronym>TCP</acronym> .
      </simpara>
     </listitem>
    </orderedlist>
    Agora, todas as mensagens aparecerá no computador que está "ouvindo",<emphasis> mesmo que você desligue com <function>error_reporting</function></emphasis>.
   </para>
  </sect1>

  <sect1 id="debugger-protocol">
   <title>Protocolo do Debugger</title>
   <para>
    O protocolo é baseado em linhas. Cada linha tem um <emphasis>tipo</emphasis>, e várias linhas compondo a <emphasis>mensagem</emphasis>.  Cada mensagem começa com uma linha de tipo <literal>start</literal> e termina com uma linha de tipo <literal>end</literal>. O PHP pode emviar linhas para diferentes mensagens simultaneamente.
   </para>
   <para>
    Uma linha tem este formato:
    <informalexample>
     <literallayout>
<replaceable>date</replaceable> <replaceable>time</replaceable>
<replaceable>host</replaceable>(<replaceable>pid</replaceable>)
<replaceable>type</replaceable>:
<replaceable>message-data</replaceable>
     </literallayout>
    </informalexample>
    <variablelist>
     <varlistentry>
      <term><replaceable>date</replaceable></term>
      <listitem>
       <simpara>
	Data no formato ISO 8601
	(<replaceable>yyyy</replaceable>-<replaceable>mm</replaceable>-<replaceable>dd</replaceable>)
       </simpara>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><replaceable>time</replaceable></term>
      <listitem>
       <simpara>Hora, incluindo microsegundos:
	<replaceable>hh</replaceable>:<replaceable>mm</replaceable>:<replaceable>uuuuuu</replaceable>
       </simpara>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><replaceable>host</replaceable></term>
      <listitem>
       <simpara>
	"Nome DNS ou IP da maquina onde está o script".
       </simpara>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><replaceable>pid</replaceable></term>
      <listitem>
       <simpara>
	ID do processo na <replaceable>máquina</replaceable> do processo que gerou este erro de script.
       </simpara>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><replaceable>type</replaceable></term>
      <listitem>
       <para>
	Tipo da linha. Informa o programa sobre como ele deve tratar os seguintes dados:
	<table>
	 <title>Tipos de Linhas de Debug</title>
	 <tgroup cols="2">
	  <thead>
	   <row>
	    <entry>Nome</entry>
	    <entry>Significado</entry>
	   </row>
	  </thead>
	  <tbody>
	   <row>
	    <entry><literal>start</literal></entry> 
	    <entry>
	     Informa ao programa que a mensagem começa aqui. O conteúdo de <replaceable>data</replaceable> será o tipo de erro da mensagem, listado abaixo.
	    </entry>
	   </row>
	   <row>
	    <entry><literal>message</literal></entry>
	    <entry>A mensagem de erro do PHP.</entry>
	   </row>
	   <row>
	    <entry><literal>location</literal></entry>
	    <entry>
	     Arquivo e número da linha onde ocorreu o erro. A primeira linha <literal>location</literal> sempre conterá o nível superior.
	     <replaceable>data</replaceable> conterá:
	     <literal><replaceable>arquivo</replaceable>:<replaceable>linha</replaceable></literal>.
	     Sempre existirá uma linha <literal>location</literal> após uma <literal>message</literal> e após cada <literal>function</literal>.
	    </entry>
	   </row>
	   <row>
	    <entry>
	     <literal>frames</literal></entry> <entry>Número de janelas (frames)
	     na saida atual. Se houver quatro níveis, será esperado informação sobre quatro níveis de funções chamadas.
	     Se não for dada nenhuma linha de janela (frame) assume que o valor é 0
	     (o erro aconteceu no início).
	    </entry>
	   </row>
	   <row>
	    <entry>
	     <literal>function</literal></entry> 
	    <entry>
	     Nome da função onde o erro apareceu. Será repetida para cada vez que
	     a função for chamada.
	    </entry>
	   </row>
	   <row>
	    <entry><literal>end</literal></entry> 
	    <entry>
	     Informa ao programa que a mensagem de debug termina aqui.
	    </entry>
	   </row>
	  </tbody>
	 </tgroup>
	</table>
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><replaceable>dados</replaceable></term>
      <listitem>
       <simpara>Linha de dados.</simpara>
      </listitem>
     </varlistentry>
    </variablelist>

    <table>
     <title>Tipos de erros de debugação</title>
     <tgroup cols="2">
      <thead>
       <row>
	<entry>Debugador</entry>
	<entry>Interno do PHP</entry>
       </row>
      </thead>
      <tbody>
       <row>
	<entry><errortype>atenção</errortype></entry>
	<entry><errortype>E_WARNING</errortype></entry>
       </row>
       <row>
	<entry><errortype>erro</errortype></entry>
	<entry><errortype>E_ERROR</errortype></entry>
       </row>
       <row>
	<entry><errortype>interpretação</errortype></entry>
	<entry><errortype>E_PARSE</errortype></entry>
       </row>
       <row>
	<entry><errortype>notificação</errortype></entry>
	<entry><errortype>E_NOTICE</errortype></entry>
       </row>
       <row>
	<entry><errortype>grave erro</errortype></entry>
	<entry><errortype>E_CORE_ERROR</errortype></entry>
       </row>
       <row>
	<entry><errortype>grave atenção</errortype></entry>
	<entry><errortype>E_CORE_WARNING</errortype></entry>
       </row>
       <row>
	<entry><errortype>desconhecido</errortype></entry>
	<entry>(qualquer outro)</entry>
       </row>
      </tbody>
     </tgroup>
    </table>
    
    <example>
     <title>Exemplo de Mensagem de Debug</title>
     <literallayout>
1998-04-05 23:27:400966 lucifer.guardian.no(20481) start: notice
1998-04-05 23:27:400966 lucifer.guardian.no(20481) message: Uninitialized variable
1998-04-05 23:27:400966 lucifer.guardian.no(20481) location: (null):7
1998-04-05 23:27:400966 lucifer.guardian.no(20481) frames: 1
1998-04-05 23:27:400966 lucifer.guardian.no(20481) function: display
1998-04-05 23:27:400966 lucifer.guardian.no(20481) location: /home/ssb/public_html/test.php3:10
1998-04-05 23:27:400966 lucifer.guardian.no(20481) end: notice
     </literallayout>
    </example>
   </para>
  </sect1>

 </appendix>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
sgml-parent-document:nil
sgml-default-dtd-file:"../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
-->
